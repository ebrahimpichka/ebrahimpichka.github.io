<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Solve Optimization Problems on Google Cloud Platform using Google’s OR API and OR-tools MathOpt | Ebrahim Pichka</title> <meta name="author" content="Ebrahim Pichka"> <meta name="description" content="A quick guide to implementing and solving mathematical optimization models using Google Cloud Platform (GCP) with OR-tools MathOpt interface and OR API endpoints in Python."> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon_32.png"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://epichka.com/blog/2024/ortools-mathopt/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Ebrahim Pichka</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Code</a> </li> <li class="nav-item "> <a class="nav-link" href="/resources/">Resources</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Solve Optimization Problems on Google Cloud Platform using Google’s OR API and OR-tools MathOpt</h1> <p class="post-meta">September 29, 2024</p> <p class="post-tags"> <a href="/blog/2024"> <i class="fas fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/operations-research"> <i class="fas fa-hashtag fa-sm"></i> operations-research</a>   <a href="/blog/tag/optimization"> <i class="fas fa-hashtag fa-sm"></i> optimization</a>   <a href="/blog/tag/or"> <i class="fas fa-hashtag fa-sm"></i> OR</a>     ·   <a href="/blog/category/optimization"> <i class="fas fa-tag fa-sm"></i> optimization</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p>A quick guide to implementing and solving mathematical optimization models using Google Cloud Platform (GCP) with OR-tools MathOpt interface and OR API endpoints in Python.</p> <p><img src="https://cdn-images-1.medium.com/max/2000/1*FbEMA7eGy_ZEjZb6Y06c-w.jpeg" alt="" style="margin:auto; display:block;" class="img-fluid rounded z-depth-1"></p> <hr> <h2 id="introduction">Introduction</h2> <p>Operations Research and Mathematical Optimization practitioners and developers often face challenges when dealing with large-scale or even medium-sized optimization problems on their local machines, such as hardware and resource constraints, dependency management, etc.</p> <p>Google’s new <a href="https://developers.google.com/optimization/service" rel="external nofollow noopener" target="_blank"><strong>OR API</strong></a>, part of the OR-tools suite, offers a solution by allowing users to solve <strong>linear</strong>, <strong>mixed-integer</strong>, and <strong>quadratic</strong> programming problems on remote cloud services of GCP. This way we can use Google’s computing infrastructure to handle solving complex models that might be impractical to solve on a single machine due to memory or time constraints.</p> <p><img src="https://cdn-images-1.medium.com/max/2000/1*sK1UjX9ppF0UsQw_QbA1xw.jpeg" alt="" style="margin:auto; display:block;" class="img-fluid rounded z-depth-1"></p> <p>In this post, we’ll explore how to use this API to formulate and solve optimization problems, focusing on its integration with OR-Tools, Google’s open-source software suite for optimization. We’ll cover the basics of problem formulation, discuss the supported solvers like GLOP, PDLP, and SCIP, and walk through the process of sending models to the cloud service for resolution.</p> <hr> <h2 id="supported-problems">Supported Problems</h2> <p>Google’s OR API offers two problem-specific endpoints as well as a general endpoint to solve any custom modeled mathematical program.</p> <p>The problem-specific endpoints will not be the main focus of this post. Feel free to dig into their documentation if the suit your needs. These endpoints cover:</p> <ul> <li> <p><a href="https://developers.google.com/optimization/service/scheduling/workforce_scheduling" rel="external nofollow noopener" target="_blank"><strong>Workforce Scheduling</strong></a>: offers two solvers using the <a href="https://developers.google.com/optimization/service/reference/rest/v1/scheduling/solveShiftGeneration" rel="external nofollow noopener" target="_blank">SolveShiftGeneration</a> and <a href="https://developers.google.com/optimization/service/reference/rest/v1/scheduling/solveShiftScheduling" rel="external nofollow noopener" target="_blank">SolveShiftScheduling</a> methods.</p> </li> <li> <p><a href="https://developers.google.com/optimization/service/shipping/network_design" rel="external nofollow noopener" target="_blank"><strong>Shipping Network Design</strong></a>:Solves the Liner Shipping Network Design and Scheduling Problem (LSNDSP). The problem involves the design and scheduling of a liner shipping network that minimizes operational costs, while maximizing revenue from the shipping of commodity demand between ports.</p> </li> </ul> <p>The general endpoint, namely <strong>The MathOpt Service</strong>, uses <a href="https://developers.google.com/optimization/math_opt" rel="external nofollow noopener" target="_blank">MathOpt</a> as input format. <a href="https://developers.google.com/optimization/math_opt" rel="external nofollow noopener" target="_blank">MathOpt</a> is a new feature from the Google OR-tools suite that provides a unified <strong>modelling interface</strong>, that separates modelling and solving stages in math programming. After modelling is done in MathOpt, the model can be coupled up with any different Solvers and methods by just easily changing an ENUM for the solver parameter, for faster and better experiments. We’ll see how it’s done below in examples.</p> <p>In terms of generality, MathOpt models can contain:</p> <ul> <li> <p>Integer or continuous variables</p> </li> <li> <p>Linear or quadratic constraints</p> </li> <li> <p>Linear or quadratic objectives</p> </li> </ul> <p>Models are defined independently of any solver and solvers can be swapped interchangeably. Currently following solvers are supported in MathOpt Service (the cloud endpoint):</p> <ul> <li> <p><a href="https://developers.google.com/optimization/lp/lp_advanced" rel="external nofollow noopener" target="_blank">GLOP</a>: Google’s Glop linear solver. Supports LP with primal and dual simplex methods.</p> </li> <li> <p><a href="https://developers.google.com/optimization/lp/pdlp_math" rel="external nofollow noopener" target="_blank">PDLP</a>: Google’s PDLP solver. Supports LP and convex diagonal quadratic objectives. Uses first order methods rather than simplex. Can solve very large problems.</p> </li> <li> <p><a href="https://developers.google.com/optimization/cp/cp_solver" rel="external nofollow noopener" target="_blank">CP-SAT</a>: Google’s CP-SAT solver. Supports problems where all variables are integer and bounded (or implied to be after presolve).</p> </li> <li> <p><a href="https://www.scipopt.org/" rel="external nofollow noopener" target="_blank">SCIP</a>: Solving Constraint Integer Programs (SCIP) solver (third party). Supports LP, MIP, and nonconvex integer quadratic problems. No dual data for LPs is returned though. Prefer GLOP for LPs.</p> </li> <li> <p><a href="https://www.gnu.org/software/glpk/" rel="external nofollow noopener" target="_blank">GLPK</a>: GNU Linear Programming Kit (GLPK) (third party). Supports MIP and LP.</p> </li> <li> <p><a href="https://osqp.org/" rel="external nofollow noopener" target="_blank">OSQP</a>: The Operator Splitting Quadratic Program (OSQP) solver (third party). Supports continuous problems with linear constraints and linear or convex quadratic objectives. Uses a first-order method.</p> </li> <li> <p><a href="https://highs.dev/" rel="external nofollow noopener" target="_blank">HiGHS</a>: The HiGHS Solver (third party). Supports LP and MIP problems (convex QPs are unimplemented).</p> </li> </ul> <p>Note that MathOpt itself supports a wider range of solver, the above were the one currently supported in the OR API.</p> <hr> <h2 id="how-to-use-it--examples">How to use it + Examples</h2> <p>In general, the process of solving a model using MathOpt Service has three steps:</p> <ol> <li> <p>Modelling</p> </li> <li> <p>Solver Parameter Setting</p> </li> <li> <p>Making a request to OR API.</p> </li> </ol> <p>But first, you have to follow <a href="https://developers.google.com/optimization/service/setup" rel="external nofollow noopener" target="_blank"><strong>THESE INITIAL STEPS</strong></a> once, to obtain your OR <strong>api_key</strong> from GCP. You also need to have OR-tools installed locally. See how to <a href="https://developers.google.com/optimization/install" rel="external nofollow noopener" target="_blank">install OR-tools</a>.</p> <h3 id="step-1-modelling">Step 1: Modelling</h3> <p>All the modelling is done through the mathopt module. In python, it is imported as follows:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">ortools.math_opt.python</span> <span class="kn">import</span> <span class="n">mathopt</span>
</code></pre></div></div> <p><strong>Example 1:</strong></p> <p>Consider the following Linear Program (LP):</p> <p><img src="https://cdn-images-1.medium.com/max/2000/1*9njAs5wz6DCbF9Qa-j9ytQ.png" alt="" style="margin:auto; display:block;" class="img-fluid rounded z-depth-1"></p> <p>Then modelling using the mathopt interface is as easy as:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Example 1: Simple LP
</span><span class="n">model</span> <span class="o">=</span> <span class="n">mathopt</span><span class="p">.</span><span class="nc">Model</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">example_lp</span><span class="sh">"</span><span class="p">)</span>
<span class="n">x_1</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">add_variable</span><span class="p">(</span><span class="n">lb</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">is_integer</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">x_1</span><span class="sh">"</span><span class="p">)</span>
<span class="n">x_2</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">add_variable</span><span class="p">(</span><span class="n">lb</span><span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="mf">3.</span> <span class="p">,</span> <span class="n">is_integer</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">x_2</span><span class="sh">"</span><span class="p">)</span>
<span class="n">x_3</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">add_variable</span><span class="p">(</span><span class="n">lb</span><span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="mf">5.</span> <span class="p">,</span> <span class="n">is_integer</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">x_3</span><span class="sh">"</span><span class="p">)</span>
<span class="n">model</span><span class="p">.</span><span class="nf">add_linear_constraint</span><span class="p">(</span><span class="n">x_1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x_2</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x_3</span> <span class="o">&lt;=</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">model</span><span class="p">.</span><span class="nf">maximize</span><span class="p">(</span><span class="n">x_1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x_2</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">x_3</span><span class="p">)</span>
</code></pre></div></div> <p><strong>Example 2:</strong></p> <p>Consider a basic <strong><em>N by N</em></strong> <a href="https://en.wikipedia.org/wiki/Assignment_problem" rel="external nofollow noopener" target="_blank">assignment problem</a> with the following integer (binary) linear program:</p> <p><img src="https://cdn-images-1.medium.com/max/2000/1*IlFCaK4jypqKpu2Hd7zr1w.png" alt="" style="margin:auto; display:block;" class="img-fluid rounded z-depth-1"></p> <p>where decision variable x_ij is 1 if source <strong><em>i</em></strong> is assigned to target <strong><em>j</em></strong>, and 0 otherwise. And the constraints make sure each source is exactly assigned to one target and vice versa. This model is implemented using mathopt as follows:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Example 1: Assignment IP
</span>
<span class="c1"># n: number of sources/targets
# W: nxn numpy array of coefficients
</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">mathopt</span><span class="p">.</span><span class="nc">Model</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">example_assignment</span><span class="sh">"</span><span class="p">)</span>
<span class="n">X_mat</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="n">model</span><span class="p">.</span><span class="nf">add_binary_variable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="sh">"</span><span class="s">x_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s">_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="c1"># equivalently can use either:
</span>            <span class="c1"># model.add_variable(lb=0., ub=1., is_integer=True, name=f"x_{i}_{j}")
</span>            <span class="c1"># model.add_integer_variable(lb=0., ub=1., name=f"x_{i}_{j}")
</span>      <span class="p">]</span>

<span class="c1"># Objective function
</span><span class="n">obj</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span>
      <span class="n">W</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">X_mat</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">t</span><span class="p">]</span>
      <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="c1"># source indices
</span>      <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="c1"># target indices
</span>      <span class="p">)</span>
<span class="c1"># Consraintsfunction
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
      <span class="n">model</span><span class="p">.</span><span class="nf">add_linear_constraint</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="n">X_mat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
      <span class="n">model</span><span class="p">.</span><span class="nf">add_linear_constraint</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="n">X_mat</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <p>That all! Now let’s see how we can solve these models.</p> <h3 id="steps-23-parameter-setting-and-solving">Steps 2–3: Parameter Setting and Solving</h3> <p>In general when we not use the GCP API service, and want to solve a model such as the above mentioned example models locally with mathopt. The models are solved as follows:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">params</span> <span class="o">=</span> <span class="n">mathopt</span><span class="p">.</span><span class="nc">SolveParameters</span><span class="p">(</span><span class="n">enable_output</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">mathopt</span><span class="p">.</span><span class="nf">solve</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">mathopt</span><span class="p">.</span><span class="n">SolverType</span><span class="p">.</span><span class="n">GLOP</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span><span class="p">.</span><span class="n">termination</span><span class="p">.</span><span class="n">reason</span> <span class="o">!=</span> <span class="n">mathopt</span><span class="p">.</span><span class="n">TerminationReason</span><span class="p">.</span><span class="n">OPTIMAL</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nc">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">model failed to solve: </span><span class="si">{</span><span class="n">result</span><span class="p">.</span><span class="n">termination</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div> <p>As you can see, it does not really matter which model (from example 1 or 2) we want to solve, the process is the same nonetheless. The important point is to select the most appropriate solver for our problem. The solver can be changed using the corresponding ENUM from the following list:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Solvers supported in MathOpt Service (OR API)</span>
<span class="na">GSCIP</span><span class="pi">:</span>     <span class="s">mathopt.SolverType.GSCIP</span>
<span class="na">GLOP</span><span class="pi">:</span>      <span class="s">mathopt.SolverType.GLOP</span>
<span class="na">CP_SAT</span><span class="pi">:</span>    <span class="s">mathopt.SolverType.CP_SAT</span>
<span class="na">PDLP</span><span class="pi">:</span>      <span class="s">mathopt.SolverType.PDLP</span>
<span class="na">GLPK</span><span class="pi">:</span>      <span class="s">mathopt.SolverType.GLPK</span>
<span class="na">OSQP</span><span class="pi">:</span>      <span class="s">mathopt.SolverType.OSQP</span>
<span class="na">HIGHS</span><span class="pi">:</span>     <span class="s">mathopt.SolverType.HIGHS</span>

<span class="c1"># Additional sovers for local use</span>
<span class="na">ECOS</span><span class="pi">:</span>      <span class="s">mathopt.SolverType.ECOS</span>
<span class="na">SCS</span><span class="pi">:</span>       <span class="s">mathopt.SolverType.SCS</span>
<span class="na">GUROBI</span><span class="pi">:</span>    <span class="s">mathopt.SolverType.GUROBI</span>
<span class="na">SANTORINI</span><span class="pi">:</span> <span class="s">mathopt.SolverType.SANTORINI</span>
</code></pre></div></div> <p>For parameters argument params you are able to set the following additional parameters depending on the chosen solver:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">time_limit</span><span class="pi">:</span> <span class="s">The maximum time a solver should spend on the problem,</span>
<span class="pi">-</span> <span class="na">iteration_limit</span><span class="pi">:</span> <span class="s">Limit on the iterations of the underlying algorithm (e.g.</span>
      <span class="s">simplex pivots).</span> 
<span class="pi">-</span> <span class="na">node_limit</span><span class="pi">:</span> <span class="s">Limit on the number of subproblems solved in enumerative search</span>
      <span class="s">(e.g. branch and bound).</span>
<span class="pi">-</span> <span class="na">cutoff_limit</span><span class="pi">:</span> <span class="s">The solver stops early if it can prove there are no primal</span>
      <span class="s">solutions at least as good as cutoff.</span>
<span class="pi">-</span> <span class="na">objective_limit</span><span class="pi">:</span> <span class="s">The solver stops early as soon as it finds a solution at</span>
      <span class="s">least this good, with TerminationReason.FEASIBLE and Limit.OBJECTIVE.</span>
<span class="pi">-</span> <span class="na">best_bound_limit</span><span class="pi">:</span> <span class="s">The solver stops early as soon as it proves the best bound</span>
      <span class="s">is at least this good, with TerminationReason of FEASIBLE or</span>
      <span class="s">NO_SOLUTION_FOUND and Limit.OBJECTIVE.</span>
<span class="pi">-</span> <span class="na">solution_limit</span><span class="pi">:</span> <span class="s">The solver stops early after finding this many feasible</span>
      <span class="s">solutions, with TerminationReason.FEASIBLE and Limit.SOLUTION. Must be</span>
      <span class="s">greater than zero if set</span>
<span class="pi">-</span> <span class="na">enable_output</span><span class="pi">:</span> <span class="s">If the solver should print out its log messages.</span>
<span class="pi">-</span> <span class="na">absolute_gap_tolerance</span><span class="pi">:</span> <span class="s">An absolute optimality tolerance (primarily) for MIP</span>
      <span class="s">solvers. The absolute GAP is the absolute value of the difference between</span>

<span class="pi">-</span> <span class="na">relative_gap_tolerance</span><span class="pi">:</span> <span class="s">A relative optimality tolerance (primarily) for MIP</span>
      <span class="s">solvers. The relative GAP is a normalized version of the absolute GAP.</span>
<span class="pi">-</span> <span class="na">solution_pool_size</span><span class="pi">:</span> <span class="s">Maintain up to `solution_pool_size` solutions while</span>
      <span class="s">searching.</span>
<span class="pi">-</span> <span class="na">lp_algorithm</span><span class="pi">:</span> <span class="s">The algorithm for solving a linear program. If UNSPECIFIED,</span>
      <span class="s">use the solver default algorithm.</span>
<span class="pi">-</span> <span class="na">presolve</span><span class="pi">:</span> <span class="s">Effort on simplifying the problem before starting the main</span>
      <span class="s">algorithm (e.g. simplex).</span>
<span class="pi">-</span> <span class="na">cuts</span><span class="pi">:</span> <span class="s">Effort on getting a stronger LP relaxation (MIP only). Note that in</span>
      <span class="s">some solvers, disabling cuts may prevent callbacks from having a chance to</span>
      <span class="s">add cuts at MIP_NODE.</span>
<span class="pi">-</span> <span class="na">heuristics</span><span class="pi">:</span> <span class="s">Effort in finding feasible solutions beyond those encountered in</span>
      <span class="s">the complete search procedure.</span>
<span class="pi">-</span> <span class="na">scaling</span><span class="pi">:</span> <span class="s">Effort in rescaling the problem to improve numerical stability.</span>
<span class="pi">-</span> <span class="na">gscip</span><span class="pi">:</span> <span class="s">GSCIP specific solve parameters.</span>
<span class="pi">-</span> <span class="na">gurobi</span><span class="pi">:</span> <span class="s">Gurobi specific solve parameters.</span>
<span class="pi">-</span> <span class="na">glop</span><span class="pi">:</span> <span class="s">Glop specific solve parameters.</span>
<span class="pi">-</span> <span class="na">cp_sat</span><span class="pi">:</span> <span class="s">CP-SAT specific solve parameters.</span>
<span class="pi">-</span> <span class="na">pdlp</span><span class="pi">:</span> <span class="s">PDLP specific solve parameters.</span>
<span class="pi">-</span> <span class="na">osqp</span><span class="pi">:</span> <span class="s">OSQP specific solve parameters.</span> 
<span class="pi">-</span> <span class="na">glpk</span><span class="pi">:</span> <span class="s">GLPK specific solve parameters.</span>
<span class="pi">-</span> <span class="na">highs</span><span class="pi">:</span> <span class="s">HiGHS specific solve parameters.</span>
</code></pre></div></div> <p>You can check out <a href="https://github.com/google/or-tools/blob/stable/ortools/math_opt/python/parameters.py" rel="external nofollow noopener" target="_blank">MathOpt’s source code here</a> for more details on supporting parameters.</p> <p>Now when using the OR API to solve the model remotely on GCP, the procedure differs a little bit. For this, we use the remote_http_solve module from OR-tools, as follows:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">ortools.math_opt.python</span> <span class="kn">import</span> <span class="n">mathopt</span>
<span class="kn">from</span> <span class="n">ortools.math_opt.python.ipc</span> <span class="kn">import</span> <span class="n">remote_http_solve</span>

<span class="c1"># Read the API Key from a JSON file with the format:
# {"key": "your_api_key"}
</span><span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">credentials.json</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
      <span class="n">credentials</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
      <span class="n">api_key</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="sh">"</span><span class="s">key</span><span class="sh">"</span><span class="p">]</span>
      
<span class="n">model</span> <span class="o">=</span> <span class="p">...</span> <span class="c1"># define the model similar to examples 1,2 above
</span>
<span class="k">try</span><span class="p">:</span>
      <span class="c1"># solving remotely on GCP
</span>      <span class="n">result</span><span class="p">,</span> <span class="n">logs</span> <span class="o">=</span> <span class="n">remote_http_solve</span><span class="p">.</span><span class="nf">remote_http_solve</span><span class="p">(</span>
      <span class="n">model</span><span class="p">,</span>
      <span class="n">mathopt</span><span class="p">.</span><span class="n">SolverType</span><span class="p">.</span><span class="n">GSCIP</span><span class="p">,</span>   <span class="c1"># or any solver from the list above
</span>      <span class="n">mathopt</span><span class="p">.</span><span class="nc">SolveParameters</span><span class="p">(</span><span class="n">enable_output</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
      <span class="n">api_key</span><span class="o">=</span><span class="n">api_key</span><span class="p">,</span> <span class="c1"># Other additional solving parameters can be set from the above list
</span>      <span class="p">)</span>
      <span class="n">sol_obj</span> <span class="o">=</span> <span class="n">result</span><span class="p">.</span><span class="nf">objective_value</span><span class="p">()</span>
      <span class="n">sol_var</span> <span class="o">=</span> <span class="n">result</span><span class="p">.</span><span class="nf">variable_values</span><span class="p">()</span>
      <span class="n">sol_var</span> <span class="o">=</span> <span class="p">{</span><span class="n">var</span><span class="p">.</span><span class="n">name</span><span class="p">:</span> <span class="n">val</span> <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">sol_var</span><span class="p">.</span><span class="nf">items</span><span class="p">()}</span>


      <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Objective value: </span><span class="sh">"</span><span class="p">,</span> <span class="n">sol_obj</span><span class="p">)</span>
      <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Solution: </span><span class="sh">"</span><span class="p">,</span> <span class="n">sol_var</span><span class="p">)</span>
      <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">logs</span><span class="p">))</span>

<span class="k">except</span> <span class="n">remote_http_solve</span><span class="p">.</span><span class="n">OptimizationServiceError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="nf">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
</code></pre></div></div> <p>That’s it! You solved a model without depending on your machine’s resources completely remotely on GCP.</p> <p>See the complete code examples below:</p> <p><strong>Example 1:</strong></p> <script src="https://gist.github.com/ebrahimpichka/21236defd4f9f8def8f4ca70210d9f6b.js"></script> <p><strong>Example 2: (Assignment problem ILP)</strong></p> <script src="https://gist.github.com/ebrahimpichka/1c676b185151292dcde54b5610e1eea8.js"></script> <p>For more information about Google OR-tools’ new MathOpt module you can also check these resources out:</p> <ul> <li><a href="https://developers.google.com/optimization/math_opt" rel="external nofollow noopener" target="_blank"><strong>OR-Tools | Google for Developers</strong></a></li> <li><a href="https://youtu.be/L5b4YQowXBg" rel="external nofollow noopener" target="_blank"><strong>MathOpt: Solver Independent Modeling in Google’s OR-Tools | Ross Anderson | JuliaCon 2023</strong></a></li> <li><a href="https://github.com/google/or-tools/tree/stable/ortools/math_opt" rel="external nofollow noopener" target="_blank"><strong>Google’s Operations Research tools</strong></a></li> </ul> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/autodiff/">Automatic Differentiation (AutoDiff): A Brief Intro with Examples</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/qkv-transformer/">What is Query, Key, and Value (QKV) in the Transformer Architecture and Why Are They Used?</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/gat-paper-explained/">Graph Attention Networks Paper Explained With Illustration and PyTorch Implementation</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/pg-math-explained/">Policy Gradient Algorithm’s Mathematics Explained with PyTorch Implementation</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2022/rl-resources/">Resources to Learn Reinforcement Learning</a> </li> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Ebrahim Pichka. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js"></script> <script defer src="/assets/js/common.js"></script> <script defer src="/assets/js/copy_code.js" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-JF4RVNMJBY"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JF4RVNMJBY");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>